
# 基金趋势可视化与持仓管理工具

一款交互式的 Web 应用，旨在帮助用户跟踪、可视化、比较多支投资基金的历史表现，并管理个人持仓信息。

## 部署故障排除 (Troubleshooting)

### 🚨 部署后出现 Tailwind CSS 警告

如果您在 Netlify 或其他平台部署后，控制台显示以下红色警告：
`cdn.tailwindcss.com should not be used in production...`

**解释**:
这是一个提示性警告。由于本项目为了保持轻量级和便于在线编辑，直接使用了 Tailwind CSS 的 CDN 版本。在生产环境中，它可能会导致页面加载时的样式闪烁，但在功能上通常不会导致应用崩溃。

**解决方法**:
1.  **无需操作**: 该警告不会影响应用的正常功能，您可以忽略它。
2.  **已自动屏蔽**: 最新版本的代码已在 `index.html` 中添加了脚本来拦截此特定的控制台警告，以保持控制台整洁。

### 🚨 部署后出现白屏 (Blank Screen)

如果您在 Netlify 或其他平台部署后网页显示一片空白，通常是因为**环境变量缺失**导致构建出的代码在浏览器中运行时报错。

**原因**: 
项目依赖 `GEMINI_API_KEY`。如果构建时未找到该变量，Vite 默认可能会将代码中的 `process.env.API_KEY` 保留，而浏览器无法识别 `process` 对象，导致 `ReferenceError: process is not defined` 错误，应用崩溃。

**解决方法**:

1.  **配置环境变量**:
    *   登录 **Netlify** 控制台。
    *   进入 **Site Settings** > **Environment variables**。
    *   添加变量:
        *   Key: `GEMINI_API_KEY`
        *   Value: `您的_Google_Gemini_API_Key` (如果没有，可以填任意非空字符串以恢复页面显示，但 AI 功能将不可用)。
    *   **重新部署 (Trigger Deploy)** 以应用更改。

2.  **代码层面的修复 (已包含)**:
    *   最新代码已在 `vite.config.ts` 中添加了安全回退逻辑 (`|| ''`)，确保即使未配置环境变量，应用也能正常加载（白屏问题已修复），仅 AI智能投顾功能会提示错误。

### ✅ 微信域名归属验证

已添加微信验证文件 `923933dc37a6e22bac3d6b877c4e1bc6.txt` 至 `public` 目录。
Vite 构建时会自动将其复制到站点根目录，满足微信“将验证文件部署在网站根目录下”的要求。

## 核心功能

- **[UI 优化] 提示框视觉统一**:
    - 移除了基金走势图中 Tooltip 的所有灰色分割线（包括基准比较模式），保持视觉一致性。
    - 自动移除日期中的时分显示，仅展示 YYYY-MM-DD，使信息呈现更纯粹。
- **[UI 优化] 基准比较模式增强**:
    - 在折线图设置基准点后，Tooltip 头部将展示日期范围（如：`2025-11-18 1天 2025-11-19`），更直观地呈现时间跨度。
- **[UI 优化] 提示框极致压缩**:
    - 压缩了行间距 (`space-y-0.5`) 并缩小了字体与边距，使提示框整体更加紧凑、现代。
- **[UI 优化] 标签分析视觉分区**:
    - 为标签分析表格的“累计总值”、“累计收益率”、“今日收益率”列添加了深色右边框分割线。这种设计参考了切片分析表格的样式，通过物理视觉障碍帮助用户更快地区分“资产规模”、“盈利能力”和“即时表现”三大逻辑板块。
- **[UI 优化] 标签分析排序逻辑**:
    - 点击标签分析表格的表头时，排序切换顺序优化为：**降序 -> 升序 -> 绝对值升序 -> 绝对值降序**。这更符合用户从整体趋势到局部偏差的分析习惯。
- **[UI 优化] 智能滚动归位**:
    - 在进行标签筛选、双击标签或点击持仓切片日期后，系统会自动平滑滚动至基金列表。
    - **增强**: 滚动时不仅对齐顶部，还会自动将横向滚动重置为 0，确保“基金名称”首列始终清晰可见，避免在查看历史日期后切换筛选导致的视角偏移。
- **[新交互] 折线图局部锚点对比**:
    - **极简操作**: 直接在任意基金的折线图上点击某个点，即可将其设为该基金的“基准日”。
    - **动态对比**: 设置基准后，Hover 图表其他点时，Tooltip 会实时显示“较基准涨跌”百分比。
    - **独立状态**: 锚点状态为每支基金独立维护，互不干扰，方便单独复盘某支基金的特定区间表现。
    - **快速切换**: 再次点击相同点取消，点击其他点快速切换。
- **[UI 增强] 综合图表提示**:
    - **悬停提示 (Tooltip) 深度升级**: 折线图悬停时，现在会显示：
        1. **当日涨跌幅** 与 **当日收益**；
        2. **距今/较基准涨跌幅**: 即该日期净值到最新净值（或自定义基准日）的累计变动百分比；
        3. **交易详情**: 若该日有交易，会直接列出类型（买入/卖出/分红）及金额，移除了成交净值展示并取消了虚线分割，使视觉更加一体化。
- **[性能优化] 极速悬停联动**:
    - **持仓切仓分析联动升级**: 为平衡操作便利性与流畅度，切片分析表格现已恢复为经典的“**悬停触发**”联动模式。通过**组件细粒度拆分**与 **React.memo** 策略，实现了行与图表的高频同步，彻底解决了之前版本中鼠标悬停时的卡顿感，交互反馈灵敏。
- **[UI 细节优化] 持仓切片分析表格**:
    - 移除了“机会收益”列右侧的加重灰色边框，使卖出相关的三个子列（卖出、机会收益、落袋）在视觉上归为一组，逻辑呈现更清晰。
- **[UI 优化] 沉浸式滚动体验**:
    - **隐藏主页面竖向滚动条**: 为了提供更干净、现代的视觉体验，移除了浏览器主窗口右侧的默认竖向滚动条。
    - **功能保留**: 页面内容的竖向滚动功能**完全保留**，您依然可以通过鼠标滚轮、触控板或键盘方向键流畅浏览长列表。
- **[核心] 智能推荐评分系统 (Smart Opportunity Score)**:
    - 系统采用一套独特的**多因子加权算法**，为您提供量化的买卖建议。
    - **评分公式**: $$ Score = (50\% \times 估值分) + (30\% \times 趋势分) + (20\% \times 今日分) $$
    - **可视化决策 (5级评级)**: 从强力买入到强力卖出，提供直观的色彩和文本指引。
- **[新优化] 列表显示增强**:
    - **定长持仓权重条**: 采用固定长度的进度条设计，左侧显示排名，右侧独立显示金额，视觉更加整洁划一。
- **[新功能] "近期有交易" 智能筛选与指示**:
    - 动态关联 Zigzag 趋势周期，智能识别当前趋势波段内有过操作的基金。
- **[新功能] Terminal 极客终端**:
    - 提供类似命令行的交互体验，支持批量 `trade` 交易指令和无未来函数的 `inspect` 历史回溯矩阵。
- **[新功能] Gemini 智能投顾**:
    - 集成 Google Gemini 2.5 Flash 模型，深度结合 **4.5% 金字塔加仓策略**，提供基于全数据上下文的操作建议。
- **持仓管理与云同步**:
    - 支持 GitHub Gist 云端同步，实现多设备数据无缝共享。

## 如何使用

1.  **添加基金**: 在页面底部的“基金代码”输入框中输入一个有效的6位基金代码。
2.  **录入持仓**: 双击基金行打开详情，输入份额与成本。
3.  **基准对比**: 在图表上点击一点作为基准，移动鼠标查看相对涨幅。
4.  **开始交易**: 在任意日期单元格点击“买/卖”录入操作，系统将自动计算切片分析并显示在下方。